%article#post
  %h1= @post.title
  %secion.post-meta
    %section.published
      %i.fa.fa-clock-o.fa-lg
      =@post.created_at.strftime("%B #{@post.created_at.day.ordinalize}, %Y")
    %section.tags
      %i.fa.fa-tags.fa-lg
      =@post.tag_list
    %section.comments
      =link_to @post do
        %i.fa.fa-comment-o.fa-lg
        %span.count= @post.comments.count
        comments
  %section.content
    - if @post.is_a?(Article)
      %p
        = markdown(@post.content)
    - else
      =image_tag(@post.image.url(:large), { class: 'meme-image', data: { 'post-id' => @post.id } })

  %section#comment_form_container
    = render 'comments/form', comment: @post.comments.build
  %section.related
    %section#comments
      - @post.comments.order('created_at DESC').each do |comment|
        =render comment
    %section#details
      %span
        %i.fa.fa-pencil
        - @post.author.username.nil? ? author = @post.author.name.split(' ').first : author = @post.author.username
        = "@#{author.downcase}"
      %span

:javascript
  $(document).ready(function() {
    app.emit('show_post')
  })
