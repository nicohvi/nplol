(function(){$(function(){var t,e,a,s,n,r,i;return window.addListenersToAssetForm=function(){return $("#new_asset").on("ajax:beforeSend",function(){return $(this).find("input[name=commit]").val("Submitting image").addClass("disabled")}),$("#new_asset").on("ajax:success",function(e,s,r,u){var o;return n()||i(),$(".assets .images").append(u.responseText),o=$(".asset:last"),t(o),a(o),dim(!1)}),$("#new_asset").on("ajax:error",function(t,e){return $(this).html(e.responseText)})},i=function(){return $(".assets").fadeIn("fast"),$(".asset-tools").fadeIn("fast")},r=function(){return $(".assets").fadeOut("fast"),$(".asset-tools").fadeOut("fast")},n=function(){return $(".asset").length>0},t=function(t){var e;return e=$("<input>").attr("type","hidden").attr("name","post[asset_attributes][]").val(t.data("asset-id")),$("form:last").append($(e))},a=function(t){return t.tipsy({fallback:"Click to see image URL",fade:!0}),t.on("click",function(){return e($(this)),$(".asset-url").val($(this).attr("src")),$(".remove-asset").data("assetId",$(this).attr("data-asset-id"))})},e=function(t){return $(".asset.active").removeClass("active"),t.addClass("active")},$(".remove-asset").on("click",function(){var t;return t=$(".asset[data-asset-id="+$(this).data("assetId")+"]"),s(t)}),s=function(t){return $.ajax({url:"/assets/"+t.attr("data-asset-id"),type:"delete"}).done(function(){return t.remove(),$(".asset-url").val(""),$("input[value="+t.attr("data-asset-id")+"]").remove(),n()?void 0:r()})},$(".asset").each(function(t,e){return a($(e))})})}).call(this);